library(reticulate)
np <- import('numpy')

nimble_mse <- np$load('../data/ldpred/nimble_mse_table.npy')
nimble_cor <- np$load('../data/ldpred/nimble_cor_table.npy')

pyro_mse <- np$load('../data/ldpred/pyro_mse_table.npy')
pyro_cor <- np$load('../data/ldpred/pyro_cor_table.npy')

mse005 <- read.table('../data/ldpred/mse_mat_0.05.txt')

mse01 <- read.table('../data/ldpred/mse_mat_0.1.txt')

mse05 <- read.table('../data/ldpred/mse_mat_0.5.txt')

mse1 <- read.table('../data/ldpred/mse_mat_1.0.txt')


cor005 <- read.table('../data/ldpred/cor_mat_0.05.txt')

cor01 <- read.table('../data/ldpred/cor_mat_0.1.txt')

cor05 <- read.table('../data/ldpred/cor_mat_0.5.txt')

cor1 <- read.table('../data/ldpred/cor_mat_1.0.txt')


names = c('beta_hat', 'MLE', 'naive_1.0', 'naive_1e-1', 'naive_1e-2', 'naive_1e-2', 'naive_1e-3', 'naive_1e-4', 'naive_1e-5', 'naive_1e-10', 'sparse')

library(RColorBrewer)
cols = brewer.pal(8, 'Set2')
max(mse1[,1])


pdf('../figs/MSE_plot.pdf', width=9)
par(oma=c(0, 1, 0, 9))
plot(1, type='n', xlab = '', ylab = '', xlim = c(0.5, 4.5), ylim = c(2e-4, 1.2), log='y', axes='F')
title(ylab='MSE', cex.lab=1.5, line=3.6, xpd='NA')

points(jitter(rep(4-0.375, 100), factor=0, amount=0.021), mse005[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(4-0.357, 4-0.393), c(mean(mse005[,1]), mean(mse005[,1])), lwd=3)
lines(c(4-0.375, 4-0.375), c(quantile(mse005[,1], 0.25), quantile(mse005[,1], 0.75)))
points(jitter(rep(4-0.2678571, 100), factor=0, amount=0.021), mse005[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(4-0.25, 4-0.286), c(mean(mse005[,3]), mean(mse005[,3])), lwd=3)
lines(c(4-0.26786, 4-0.26786), c(quantile(mse005[,3], 0.25), quantile(mse005[,3], 0.75)))
points(jitter(rep(4-0.1607142, 100), factor=0, amount=0.021), mse005[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(4-0.143, 4-0.179), c(mean(mse005[,4]), mean(mse005[,4])), lwd=3)
lines(c(4-0.1607142, 4-0.1607142), c(quantile(mse005[,4], 0.25), quantile(mse005[,4], 0.75)))
points(jitter(rep(4-0.0535713, 100), factor=0, amount=0.021), mse005[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(4-0.03571415, 4-0.07142845), c(mean(mse005[,5]), mean(mse005[,5])), lwd=3)
lines(c(4-0.0535713, 4-0.0535713), c(quantile(mse005[,5], 0.25), quantile(mse005[,5], 0.75)))
points(jitter(rep(4+0.0535716, 100), factor=0, amount=0.021), mse005[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(4+0.03571445, 4+0.07142875), c(mean(mse005[,6]), mean(mse005[,6])), lwd=3)
lines(c(4+0.0535716, 4+0.0535716), c(quantile(mse005[,6], 0.25), quantile(mse005[,6], 0.75)))
points(jitter(rep(4+0.1607145, 100), factor=0, amount=0.021), mse005[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(4+0.1428574, 4+0.1785716), c(mean(mse005[,10]), mean(mse005[,10])), lwd=3)
lines(c(4+0.1607145, 4+0.1607145), c(quantile(mse005[,10], 0.25), quantile(mse005[,10], 0.75)))
points(jitter(rep(4+0.2678574, 100), factor=0, amount=0.021), pyro_mse[,1], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(4+0.25, 4+0.2857146), c(mean(pyro_mse[,1]), mean(pyro_mse[,1])), lwd=3)
lines(c(4+0.2678574, 4+0.2678574), c(quantile(pyro_mse[,1], 0.25), quantile(pyro_mse[,1], 0.75)))
points(jitter(rep(4+0.375, 100), factor=0, amount=0.021), nimble_mse[,1], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(4+0.3571429, 4+0.3928571), c(mean(nimble_mse[,1]), mean(nimble_mse[,1])), lwd=3)
lines(c(4+0.375, 4+0.375), c(quantile(nimble_mse[,1], 0.25), quantile(nimble_mse[,1], 0.75)))


points(jitter(rep(3-0.375, 100), factor=0, amount=0.021), mse01[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(3-0.357, 3-0.393), c(mean(mse01[,1]), mean(mse01[,1])), lwd=3)
lines(c(3-0.375, 3-0.375), c(quantile(mse01[,1], 0.25), quantile(mse01[,1], 0.75)))
points(jitter(rep(3-0.2678571, 100), factor=0, amount=0.021), mse01[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(3-0.25, 3-0.286), c(mean(mse01[,3]), mean(mse01[,3])), lwd=3)
lines(c(3-0.26786, 3-0.26786), c(quantile(mse01[,3], 0.25), quantile(mse01[,3], 0.75)))
points(jitter(rep(3-0.1607142, 100), factor=0, amount=0.021), mse01[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(3-0.143, 3-0.179), c(mean(mse01[,4]), mean(mse01[,4])), lwd=3)
lines(c(3-0.1607142, 3-0.1607142), c(quantile(mse01[,4], 0.25), quantile(mse01[,4], 0.75)))
points(jitter(rep(3-0.0535713, 100), factor=0, amount=0.021), mse01[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(3-0.03571415, 3-0.07142845), c(mean(mse01[,5]), mean(mse01[,5])), lwd=3)
lines(c(3-0.0535713, 3-0.0535713), c(quantile(mse01[,5], 0.25), quantile(mse01[,5], 0.75)))
points(jitter(rep(3+0.0535716, 100), factor=0, amount=0.021), mse01[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(3+0.03571445, 3+0.07142875), c(mean(mse01[,6]), mean(mse01[,6])), lwd=3)
lines(c(3+0.0535716, 3+0.0535716), c(quantile(mse01[,6], 0.25), quantile(mse01[,6], 0.75)))
points(jitter(rep(3+0.1607145, 100), factor=0, amount=0.021), mse01[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(3+0.1428574, 3+0.1785716), c(mean(mse01[,10]), mean(mse01[,10])), lwd=3)
lines(c(3+0.1607145, 3+0.1607145), c(quantile(mse01[,10], 0.25), quantile(mse01[,10], 0.75)))
points(jitter(rep(3+0.2678574, 100), factor=0, amount=0.021), pyro_mse[,2], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(3+0.25, 3+0.2857146), c(mean(pyro_mse[,2]), mean(pyro_mse[,2])), lwd=3)
lines(c(3+0.2678574, 3+0.2678574), c(quantile(pyro_mse[,2], 0.25), quantile(pyro_mse[,2], 0.75)))
points(jitter(rep(3+0.375, 100), factor=0, amount=0.021), nimble_mse[,2], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(3+0.3571429, 3+0.3928571), c(mean(nimble_mse[,2]), mean(nimble_mse[,2])), lwd=3)
lines(c(3+0.375, 3+0.375), c(quantile(nimble_mse[,2], 0.25), quantile(nimble_mse[,2], 0.75)))


points(jitter(rep(2-0.375, 100), factor=0, amount=0.021), mse05[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(2-0.357, 2-0.393), c(mean(mse05[,1]), mean(mse05[,1])), lwd=3)
lines(c(2-0.375, 2-0.375), c(quantile(mse05[,1], 0.25), quantile(mse05[,1], 0.75)))
points(jitter(rep(2-0.2678571, 100), factor=0, amount=0.021), mse05[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(2-0.25, 2-0.286), c(mean(mse05[,3]), mean(mse05[,3])), lwd=3)
lines(c(2-0.26786, 2-0.26786), c(quantile(mse05[,3], 0.25), quantile(mse05[,3], 0.75)))
points(jitter(rep(2-0.1607142, 100), factor=0, amount=0.021), mse05[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(2-0.143, 2-0.179), c(mean(mse05[,4]), mean(mse05[,4])), lwd=3)
lines(c(2-0.1607142, 2-0.1607142), c(quantile(mse05[,4], 0.25), quantile(mse05[,5], 0.75)))
points(jitter(rep(2-0.0535713, 100), factor=0, amount=0.021), mse05[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(2-0.03571415, 2-0.07142845), c(mean(mse05[,5]), mean(mse05[,5])), lwd=3)
lines(c(2-0.0535713, 2-0.0535713), c(quantile(mse05[,5], 0.25), quantile(mse05[,5], 0.75)))
points(jitter(rep(2+0.0535716, 100), factor=0, amount=0.021), mse05[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(2+0.03571445, 2+0.07142875), c(mean(mse05[,6]), mean(mse05[,6])), lwd=3)
lines(c(2+0.0535716, 2+0.0535716), c(quantile(mse05[,6], 0.25), quantile(mse05[,6], 0.75)))
points(jitter(rep(2+0.1607145, 100), factor=0, amount=0.021), mse05[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(2+0.1428574, 2+0.1785716), c(mean(mse05[,10]), mean(mse05[,10])), lwd=3)
lines(c(2+0.1607145, 2+0.1607145), c(quantile(mse05[,10], 0.25), quantile(mse05[,10], 0.75)))
points(jitter(rep(2+0.2678574, 100), factor=0, amount=0.021), pyro_mse[,3], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(2+0.25, 2+0.2857146), c(mean(pyro_mse[,3]), mean(pyro_mse[,3])), lwd=3)
lines(c(2+0.2678574, 2+0.2678574), c(quantile(pyro_mse[,3], 0.25), quantile(pyro_mse[,3], 0.75)))
points(jitter(rep(2+0.375, 100), factor=0, amount=0.021), nimble_mse[,3], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(2+0.3571429, 2+0.3928571), c(mean(nimble_mse[,3]), mean(nimble_mse[,3])), lwd=3)
lines(c(2+0.375, 2+0.375), c(quantile(nimble_mse[,3], 0.25), quantile(nimble_mse[,3], 0.75)))



points(jitter(rep(1-0.375, 100), factor=0, amount=0.021), mse1[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(1-0.357, 1-0.393), c(mean(mse1[,1]), mean(mse1[,1])), lwd=3)
lines(c(1-0.375, 1-0.375), c(quantile(mse1[,1], 0.25), quantile(mse1[,1], 0.75)))
points(jitter(rep(1-0.2678571, 100), factor=0, amount=0.021), mse1[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(1-0.25, 1-0.286), c(mean(mse1[,3]), mean(mse1[,3])), lwd=3)
lines(c(1-0.26786, 1-0.26786), c(quantile(mse1[,3], 0.25), quantile(mse1[,3], 0.75)))
points(jitter(rep(1-0.1607142, 100), factor=0, amount=0.021), mse1[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(1-0.143, 1-0.179), c(mean(mse1[,4]), mean(mse1[,4])), lwd=3)
lines(c(1-0.1607142, 1-0.1607142), c(quantile(mse1[,4], 0.25), quantile(mse1[,4], 0.75)))
points(jitter(rep(1-0.0535713, 100), factor=0, amount=0.021), mse1[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(1-0.03571415, 1-0.07142845), c(mean(mse1[,5]), mean(mse1[,5])), lwd=3)
lines(c(1-0.0535713, 1-0.0535713), c(quantile(mse1[,5], 0.25), quantile(mse1[,5], 0.75)))
points(jitter(rep(1+0.0535716, 100), factor=0, amount=0.021), mse1[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(1+0.03571445, 1+0.07142875), c(mean(mse1[,6]), mean(mse1[,6])), lwd=3)
lines(c(1+0.0535716, 1+0.0535716), c(quantile(mse1[,6], 0.25), quantile(mse1[,6], 0.75)))
points(jitter(rep(1+0.1607145, 100), factor=0, amount=0.021), mse1[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(1+0.1428574, 1+0.1785716), c(mean(mse1[,10]), mean(mse1[,10])), lwd=3)
lines(c(1+0.1607145, 1+0.1607145), c(quantile(mse1[,10], 0.25), quantile(mse1[,10], 0.75)))
points(jitter(rep(1+0.2678574, 100), factor=0, amount=0.021), pyro_mse[,4], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(1+0.25, 1+0.2857146), c(mean(pyro_mse[,4]), mean(pyro_mse[,4])), lwd=3)
lines(c(1+0.2678574, 1+0.2678574), c(quantile(pyro_mse[,4], 0.25), quantile(pyro_mse[,4], 0.75)))
points(jitter(rep(1+0.375, 100), factor=0, amount=0.021), nimble_mse[,4], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(1+0.3571429, 1+0.3928571), c(mean(nimble_mse[,4]), mean(nimble_mse[,4])), lwd=3)
lines(c(1+0.375, 1+0.375), c(quantile(nimble_mse[,4], 0.25), quantile(nimble_mse[,4], 0.75)))



axis(side=1, at = c(-10, 10), labels=F)
axis(side=3, at = c(-10, 10), labels=F)
axis(side=1, at=c(-10, seq(1,4,1), 10), labels=c('???', expression(paste(sigma[e]^2, ' = 1.0')), expression(paste(sigma[e]^2, ' = 0.5')), expression(paste(sigma[e]^2, ' = 0.1')), expression(paste(sigma[e]^2, ' = 0.05')), '???'), las=1, cex.axis=1.3)
axis(side=2, at=c(1e-100, 1e100), labels=F)
axis(side=4, at=c(1e-100, 1e100), labels=F)
axis(side=2, at=c(1e-5, 1e-4, 1e-3, 1e-2, 1e-1, 1), las=1, labels=c('0.00001', '0.0001', '0.001', '0.01', '0.1', '1.0'), cex.axis=1.3)
axis(side=2, at=c(seq(1e-4,1e-3,1e-4), seq(1e-3,1e-2,1e-3), seq(1e-2,1e-1,1e-2), seq(1e-1,1e0,1e-1), seq(1e0, 10, 1)), labels=F)
legend(par('usr')[2], par('usr')[4], legend = c(expression(hat(beta)), expression(paste('naive, ', sigma[0]^2 == 1.0)), expression(paste('naive, ', sigma[0]^2 == 10^-2)), expression(paste('naive, ', sigma[0]^2 == 10^-4)), expression(paste('naive, ', sigma[0]^2 == 10^-10)), 'new VI scheme', 'BBBVI', 'MCMC'), pch=rep(19,8), col=cols[1:8], y.intersp=1.2, bty='n', xpd='NA', cex=1.3)
dev.off()


pdf('../figs/cor_plot.pdf')

plot(1, type='n', xlab = '', xlim = c(0.5, 4.5), ylim = c(0, 1e0), axes='F', ylab='Correlation', cex.lab = 1.3)

points(jitter(rep(4-0.375, 100), factor=0, amount=0.021), cor005[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(4-0.357, 4-0.393), c(mean(cor005[,1]), mean(cor005[,1])), lwd=3)
lines(c(4-0.375, 4-0.375), c(quantile(cor005[,1], 0.25), quantile(cor005[,1], 0.75)))
points(jitter(rep(4-0.2678571, 100), factor=0, amount=0.021), cor005[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(4-0.25, 4-0.286), c(mean(cor005[,3]), mean(cor005[,3])), lwd=3)
lines(c(4-0.26786, 4-0.26786), c(quantile(cor005[,3], 0.25), quantile(cor005[,3], 0.75)))
points(jitter(rep(4-0.1607142, 100), factor=0, amount=0.021), cor005[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(4-0.143, 4-0.179), c(mean(cor005[,4]), mean(cor005[,4])), lwd=3)
lines(c(4-0.1607142, 4-0.1607142), c(quantile(cor005[,4], 0.25), quantile(cor005[,4], 0.75)))
points(jitter(rep(4-0.0535713, 100), factor=0, amount=0.021), cor005[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(4-0.03571415, 4-0.07142845), c(mean(cor005[,5]), mean(cor005[,5])), lwd=3)
lines(c(4-0.0535713, 4-0.0535713), c(quantile(cor005[,5], 0.25), quantile(cor005[,5], 0.75)))
points(jitter(rep(4+0.0535716, 100), factor=0, amount=0.021), cor005[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(4+0.03571445, 4+0.07142875), c(mean(cor005[,6]), mean(cor005[,6])), lwd=3)
lines(c(4+0.0535716, 4+0.0535716), c(quantile(cor005[,6], 0.25), quantile(cor005[,6], 0.75)))
points(jitter(rep(4+0.1607145, 100), factor=0, amount=0.021), cor005[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(4+0.1428574, 4+0.1785716), c(mean(cor005[,10]), mean(cor005[,10])), lwd=3)
lines(c(4+0.1607145, 4+0.1607145), c(quantile(cor005[,10], 0.25), quantile(cor005[,10], 0.75)))
points(jitter(rep(4+0.2678574, 100), factor=0, amount=0.021), pyro_cor[,1], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(4+0.25, 4+0.2857146), c(mean(pyro_cor[,1]), mean(pyro_cor[,1])), lwd=3)
lines(c(4+0.2678574, 4+0.2678574), c(quantile(pyro_cor[,1], 0.25), quantile(pyro_cor[,1], 0.75)))
points(jitter(rep(4+0.375, 100), factor=0, amount=0.021), nimble_cor[,1], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(4+0.3571429, 4+0.3928571), c(mean(nimble_cor[,1]), mean(nimble_cor[,1])), lwd=3)
lines(c(4+0.375, 4+0.375), c(quantile(nimble_cor[,1], 0.25), quantile(nimble_cor[,1], 0.75)))


points(jitter(rep(3-0.375, 100), factor=0, amount=0.021), cor01[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(3-0.357, 3-0.393), c(mean(cor01[,1]), mean(cor01[,1])), lwd=3)
lines(c(3-0.375, 3-0.375), c(quantile(cor01[,1], 0.25), quantile(cor01[,1], 0.75)))
points(jitter(rep(3-0.2678571, 100), factor=0, amount=0.021), cor01[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(3-0.25, 3-0.286), c(mean(cor01[,3]), mean(cor01[,3])), lwd=3)
lines(c(3-0.26786, 3-0.26786), c(quantile(cor01[,3], 0.25), quantile(cor01[,3], 0.75)))
points(jitter(rep(3-0.1607142, 100), factor=0, amount=0.021), cor01[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(3-0.143, 3-0.179), c(mean(cor01[,4]), mean(cor01[,4])), lwd=3)
lines(c(3-0.1607142, 3-0.1607142), c(quantile(cor01[,4], 0.25), quantile(cor01[,4], 0.75)))
points(jitter(rep(3-0.0535713, 100), factor=0, amount=0.021), cor01[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(3-0.03571415, 3-0.07142845), c(mean(cor01[,5]), mean(cor01[,5])), lwd=3)
lines(c(3-0.0535713, 3-0.0535713), c(quantile(cor01[,5], 0.25), quantile(cor01[,5], 0.75)))
points(jitter(rep(3+0.0535716, 100), factor=0, amount=0.021), cor01[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(3+0.03571445, 3+0.07142875), c(mean(cor01[,6]), mean(cor01[,6])), lwd=3)
lines(c(3+0.0535716, 3+0.0535716), c(quantile(cor01[,6], 0.25), quantile(cor01[,6], 0.75)))
points(jitter(rep(3+0.1607145, 100), factor=0, amount=0.021), cor01[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(3+0.1428574, 3+0.1785716), c(mean(cor01[,10]), mean(cor01[,10])), lwd=3)
lines(c(3+0.1607145, 3+0.1607145), c(quantile(cor01[,10], 0.25), quantile(cor01[,10], 0.75)))
points(jitter(rep(3+0.2678574, 100), factor=0, amount=0.021), pyro_cor[,2], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(3+0.25, 3+0.2857146), c(mean(pyro_cor[,2]), mean(pyro_cor[,2])), lwd=3)
lines(c(3+0.2678574, 3+0.2678574), c(quantile(pyro_cor[,2], 0.25), quantile(pyro_cor[,2], 0.75)))
points(jitter(rep(3+0.375, 100), factor=0, amount=0.021), nimble_cor[,2], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(3+0.3571429, 3+0.3928571), c(mean(nimble_cor[,2]), mean(nimble_cor[,2])), lwd=3)
lines(c(3+0.375, 3+0.375), c(quantile(nimble_cor[,2], 0.25), quantile(nimble_cor[,2], 0.75)))


points(jitter(rep(2-0.375, 100), factor=0, amount=0.021), cor05[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(2-0.357, 2-0.393), c(mean(cor05[,1]), mean(cor05[,1])), lwd=3)
lines(c(2-0.375, 2-0.375), c(quantile(cor05[,1], 0.25), quantile(cor05[,1], 0.75)))
points(jitter(rep(2-0.2678571, 100), factor=0, amount=0.021), cor05[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(2-0.25, 2-0.286), c(mean(cor05[,3]), mean(cor05[,3])), lwd=3)
lines(c(2-0.26786, 2-0.26786), c(quantile(cor05[,3], 0.25), quantile(cor05[,3], 0.75)))
points(jitter(rep(2-0.1607142, 100), factor=0, amount=0.021), cor05[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(2-0.143, 2-0.179), c(mean(cor05[,4]), mean(cor05[,4])), lwd=3)
lines(c(2-0.1607142, 2-0.1607142), c(quantile(cor05[,4], 0.25), quantile(cor05[,4], 0.75)))
points(jitter(rep(2-0.0535713, 100), factor=0, amount=0.021), cor05[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(2-0.03571415, 2-0.07142845), c(mean(cor05[,5]), mean(cor05[,5])), lwd=3)
lines(c(2-0.0535713, 2-0.0535713), c(quantile(cor05[,5], 0.25), quantile(cor05[,5], 0.75)))
points(jitter(rep(2+0.0535716, 100), factor=0, amount=0.021), cor05[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(2+0.03571445, 2+0.07142875), c(mean(cor05[,6]), mean(cor05[,6])), lwd=3)
lines(c(2+0.0535716, 2+0.0535716), c(quantile(cor05[,6], 0.25), quantile(cor05[,6], 0.75)))
points(jitter(rep(2+0.1607145, 100), factor=0, amount=0.021), cor05[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(2+0.1428574, 2+0.1785716), c(mean(cor05[,10]), mean(cor05[,10])), lwd=3)
lines(c(2+0.1607145, 2+0.1607145), c(quantile(cor05[,10], 0.25), quantile(cor05[,10], 0.75)))
points(jitter(rep(2+0.2678574, 100), factor=0, amount=0.021), pyro_cor[,3], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(2+0.25, 2+0.2857146), c(mean(pyro_cor[,3]), mean(pyro_cor[,3])), lwd=3)
lines(c(2+0.2678574, 2+0.2678574), c(quantile(pyro_cor[,3], 0.25), quantile(pyro_cor[,3], 0.75)))
points(jitter(rep(2+0.375, 100), factor=0, amount=0.021), nimble_cor[,3], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(2+0.3571429, 2+0.3928571), c(mean(nimble_cor[,3]), mean(nimble_cor[,3])), lwd=3)
lines(c(2+0.375, 2+0.375), c(quantile(nimble_cor[,3], 0.25), quantile(nimble_cor[,3], 0.75)))



points(jitter(rep(1-0.375, 100), factor=0, amount=0.021), cor1[,1], col=adjustcolor(cols[1], alpha.f=0.4))
lines(c(1-0.357, 1-0.393), c(mean(cor1[,1]), mean(cor1[,1])), lwd=3)
lines(c(1-0.375, 1-0.375), c(quantile(cor1[,1], 0.25), quantile(cor1[,1], 0.75)))
points(jitter(rep(1-0.2678571, 100), factor=0, amount=0.021), cor1[,3], col=adjustcolor(cols[2], alpha.f=0.4))
lines(c(1-0.25, 1-0.286), c(mean(cor1[,3]), mean(cor1[,3])), lwd=3)
lines(c(1-0.26786, 1-0.26786), c(quantile(cor1[,3], 0.25), quantile(cor1[,3], 0.75)))
points(jitter(rep(1-0.1607142, 100), factor=0, amount=0.021), cor1[,4], col=adjustcolor(cols[3], alpha.f=0.4))
lines(c(1-0.143, 1-0.179), c(mean(cor1[,4]), mean(cor1[,4])), lwd=3)
lines(c(1-0.1607142, 1-0.1607142), c(quantile(cor1[,4], 0.25), quantile(cor1[,4], 0.75)))
points(jitter(rep(1-0.0535713, 100), factor=0, amount=0.021), cor1[,5], col=adjustcolor(cols[4], alpha.f=0.4))
lines(c(1-0.03571415, 1-0.07142845), c(mean(cor1[,5]), mean(cor1[,5])), lwd=3)
lines(c(1-0.0535713, 1-0.0535713), c(quantile(cor1[,5], 0.25), quantile(cor1[,5], 0.75)))
points(jitter(rep(1+0.0535716, 100), factor=0, amount=0.021), cor1[,6], col=adjustcolor(cols[5], alpha.f=0.4))
lines(c(1+0.03571445, 1+0.07142875), c(mean(cor1[,6]), mean(cor1[,6])), lwd=3)
lines(c(1+0.0535716, 1+0.0535716), c(quantile(cor1[,6], 0.25), quantile(cor1[,6], 0.75)))
points(jitter(rep(1+0.1607145, 100), factor=0, amount=0.021), cor1[,10], col=adjustcolor(cols[6], alpha.f=0.4))
lines(c(1+0.1428574, 1+0.1785716), c(mean(cor1[,10]), mean(cor1[,10])), lwd=3)
lines(c(1+0.1607145, 1+0.1607145), c(quantile(cor1[,10], 0.25), quantile(cor1[,10], 0.75)))
points(jitter(rep(1+0.2678574, 100), factor=0, amount=0.021), pyro_cor[,4], col=adjustcolor(cols[7], alpha.f=0.4))
lines(c(1+0.25, 1+0.2857146), c(mean(pyro_cor[,4]), mean(pyro_cor[,4])), lwd=3)
lines(c(1+0.2678574, 1+0.2678574), c(quantile(pyro_cor[,4], 0.25), quantile(pyro_cor[,4], 0.75)))
points(jitter(rep(1+0.375, 100), factor=0, amount=0.021), nimble_cor[,4], col=adjustcolor(cols[8], alpha.f=0.4))
lines(c(1+0.3571429, 1+0.3928571), c(mean(nimble_cor[,4]), mean(nimble_cor[,4])), lwd=3)
lines(c(1+0.375, 1+0.375), c(quantile(nimble_cor[,4], 0.25), quantile(nimble_cor[,4], 0.75)))



axis(side=1, at = c(-10, 10), labels=F)
axis(side=3, at = c(-10, 10), labels=F)
axis(side=1, at=c(-10, seq(1,4,1), 10), labels=c('???', expression(paste(sigma[e]^2, ' = 1.0')), expression(paste(sigma[e]^2, ' = 0.5')), expression(paste(sigma[e]^2, ' = 0.1')), expression(paste(sigma[e]^2, ' = 0.05')), '???'), las=1, cex.axis=1.3)
axis(side=4, at=c(-10, 10), labels=F)
axis(side=2, at=c(-10, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 10), las=1, cex.axis=1.3)
axis(side=2, at=seq(-2, 2, 0.1), labels=F)
dev.off()
