mse005 = read.table('../data/ldpred/mse_mat_0.05.txt')

mse01 = read.table('../data/ldpred/mse_mat_0.1.txt')

mse05 = read.table('../data/ldpred/mse_mat_0.5.txt')

mse1 = read.table('../data/ldpred/mse_mat_1.0.txt')


cor005 = read.table('../data/ldpred/cor_mat_0.05.txt')

cor01 = read.table('../data/ldpred/cor_mat_0.1.txt')

cor05 = read.table('../data/ldpred/cor_mat_0.5.txt')

cor1 = read.table('../data/ldpred/cor_mat_1.0.txt')


names = c('beta_hat', 'MLE', 'naive_1.0', 'naive_1e-1', 'naive_1e-2', 'naive_1e-2', 'naive_1e-3', 'naive_1e-4', 'naive_1e-5', 'naive_1e-10', 'sparse')

library(RColorBrewer)
cols = brewer.pal(6, 'Set2')
max(mse1[,1])


pdf('../figs/MSE_plot.pdf', width=9)
par(oma=c(0, 1, 0, 9))
plot(1, type='n', xlab = '', ylab = '', xlim = c(0.5, 4.5), ylim = c(2e-4, 1.2), log='y', axes='F')
title(ylab='MSE', cex.lab=1.5, line=3.6, xpd='NA')

points(jitter(rep(4-0.375, 1000), factor=0, amount=0.03), mse005[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(4-0.35, 4-0.4), c(mean(mse005[,1]), mean(mse005[,1])), lwd=3)
lines(c(4-0.375, 4-0.376), c(quantile(mse005[,1], 0.25), quantile(mse005[,1], 0.75)))
points(jitter(rep(4-0.225, 1000), factor=0, amount=0.03), mse005[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(4-0.2, 4-0.25), c(mean(mse005[,3]), mean(mse005[,3])), lwd=3)
lines(c(4-0.225, 4-0.225), c(quantile(mse005[,3], 0.25), quantile(mse005[,3], 0.75)))
points(jitter(rep(4-0.075, 1000), factor=0, amount=0.03), mse005[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(4-0.05, 4-0.1), c(mean(mse005[,5]), mean(mse005[,5])), lwd=3)
lines(c(4-0.075, 4-0.075), c(quantile(mse005[,5], 0.25), quantile(mse005[,5], 0.75)))
points(jitter(rep(4+0.075, 1000), factor=0, amount=0.03), mse005[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(4+0.05, 4+0.1), c(mean(mse005[,7]), mean(mse005[,7])), lwd=3)
lines(c(4+0.075, 4+0.075), c(quantile(mse005[,7], 0.25), quantile(mse005[,7], 0.75)))
points(jitter(rep(4+0.225, 1000), factor=0, amount=0.03), mse005[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(4+0.2, 4+0.25), c(mean(mse005[,9]), mean(mse005[,9])), lwd=3)
lines(c(4+0.225, 4+0.225), c(quantile(mse005[,9], 0.25), quantile(mse005[,9], 0.75)))
points(jitter(rep(4+0.375, 1000), factor=0, amount=0.03), mse005[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(4+0.35, 4+0.4), c(mean(mse005[,10]), mean(mse005[,10])), lwd=3)
lines(c(4+0.375, 4+0.375), c(quantile(mse005[,10], 0.25), quantile(mse005[,10], 0.75)))

points(jitter(rep(3-0.375, 1000), factor=0, amount=0.03), mse01[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(3-0.35, 3-0.4), c(mean(mse01[,1]), mean(mse01[,1])), lwd=3)
lines(c(3-0.375, 3-0.376), c(quantile(mse01[,1], 0.25), quantile(mse01[,1], 0.75)))
points(jitter(rep(3-0.225, 1000), factor=0, amount=0.03), mse01[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(3-0.2, 3-0.25), c(mean(mse01[,3]), mean(mse01[,3])), lwd=3)
lines(c(3-0.225, 3-0.225), c(quantile(mse01[,3], 0.25), quantile(mse01[,3], 0.75)))
points(jitter(rep(3-0.075, 1000), factor=0, amount=0.03), mse01[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(3-0.05, 3-0.1), c(mean(mse01[,5]), mean(mse01[,5])), lwd=3)
lines(c(3-0.075, 3-0.075), c(quantile(mse01[,5], 0.25), quantile(mse01[,5], 0.75)))
points(jitter(rep(3+0.075, 1000), factor=0, amount=0.03), mse01[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(3+0.05, 3+0.1), c(mean(mse01[,7]), mean(mse01[,7])), lwd=3)
lines(c(3+0.075, 3+0.075), c(quantile(mse01[,7], 0.25), quantile(mse01[,7], 0.75)))
points(jitter(rep(3+0.225, 1000), factor=0, amount=0.03), mse01[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(3+0.2, 3+0.25), c(mean(mse01[,9]), mean(mse01[,9])), lwd=3)
lines(c(3+0.225, 3+0.225), c(quantile(mse01[,9], 0.25), quantile(mse01[,9], 0.75)))
points(jitter(rep(3+0.375, 1000), factor=0, amount=0.03), mse01[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(3+0.35, 3+0.4), c(mean(mse01[,10]), mean(mse01[,10])), lwd=3)
lines(c(3+0.375, 3+0.375), c(quantile(mse01[,10], 0.25), quantile(mse01[,10], 0.75)))


points(jitter(rep(2-0.375, 1000), factor=0, amount=0.03), mse05[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(2-0.35, 2-0.4), c(mean(mse05[,1]), mean(mse05[,1])), lwd=3)
lines(c(2-0.375, 2-0.376), c(quantile(mse05[,1], 0.25), quantile(mse05[,1], 0.75)))
points(jitter(rep(2-0.225, 1000), factor=0, amount=0.03), mse05[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(2-0.2, 2-0.25), c(mean(mse05[,3]), mean(mse05[,3])), lwd=3)
lines(c(2-0.225, 2-0.225), c(quantile(mse05[,3], 0.25), quantile(mse05[,3], 0.75)))
points(jitter(rep(2-0.075, 1000), factor=0, amount=0.03), mse05[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(2-0.05, 2-0.1), c(mean(mse05[,5]), mean(mse05[,5])), lwd=3)
lines(c(2-0.075, 2-0.075), c(quantile(mse05[,5], 0.25), quantile(mse05[,5], 0.75)))
points(jitter(rep(2+0.075, 1000), factor=0, amount=0.03), mse05[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(2+0.05, 2+0.1), c(mean(mse05[,7]), mean(mse05[,7])), lwd=3)
lines(c(2+0.075, 2+0.075), c(quantile(mse05[,7], 0.25), quantile(mse05[,7], 0.75)))
points(jitter(rep(2+0.225, 1000), factor=0, amount=0.03), mse05[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(2+0.2, 2+0.25), c(mean(mse05[,9]), mean(mse05[,9])), lwd=3)
lines(c(2+0.225, 2+0.225), c(quantile(mse05[,9], 0.25), quantile(mse05[,9], 0.75)))
points(jitter(rep(2+0.375, 1000), factor=0, amount=0.03), mse05[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(2+0.35, 2+0.4), c(mean(mse05[,10]), mean(mse05[,10])), lwd=3)
lines(c(2+0.375, 2+0.375), c(quantile(mse05[,10], 0.25), quantile(mse05[,10], 0.75)))



points(jitter(rep(1-0.375, 1000), factor=0, amount=0.03), mse1[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(1-0.35, 1-0.4), c(mean(mse1[,1]), mean(mse1[,1])), lwd=3)
lines(c(1-0.375, 1-0.376), c(quantile(mse1[,1], 0.25), quantile(mse1[,1], 0.75)))
points(jitter(rep(1-0.225, 1000), factor=0, amount=0.03), mse1[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(1-0.2, 1-0.25), c(mean(mse1[,3]), mean(mse1[,3])), lwd=3)
lines(c(1-0.225, 1-0.225), c(quantile(mse1[,3], 0.25), quantile(mse1[,3], 0.75)))
points(jitter(rep(1-0.075, 1000), factor=0, amount=0.03), mse1[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(1-0.05, 1-0.1), c(mean(mse1[,5]), mean(mse1[,5])), lwd=3)
lines(c(1-0.075, 1-0.075), c(quantile(mse1[,5], 0.25), quantile(mse1[,5], 0.75)))
points(jitter(rep(1+0.075, 1000), factor=0, amount=0.03), mse1[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(1+0.05, 1+0.1), c(mean(mse1[,7]), mean(mse1[,7])), lwd=3)
lines(c(1+0.075, 1+0.075), c(quantile(mse1[,7], 0.25), quantile(mse1[,7], 0.75)))
points(jitter(rep(1+0.225, 1000), factor=0, amount=0.03), mse1[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(1+0.2, 1+0.25), c(mean(mse1[,9]), mean(mse1[,9])), lwd=3)
lines(c(1+0.225, 1+0.225), c(quantile(mse1[,9], 0.25), quantile(mse1[,9], 0.75)))
points(jitter(rep(1+0.375, 1000), factor=0, amount=0.03), mse1[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(1+0.35, 1+0.4), c(mean(mse1[,10]), mean(mse1[,10])), lwd=3)
lines(c(1+0.375, 1+0.375), c(quantile(mse1[,10], 0.25), quantile(mse1[,10], 0.75)))

axis(side=1, at = c(-10, 10), labels=F)
axis(side=3, at = c(-10, 10), labels=F)
axis(side=1, at=c(-10, seq(1,4,1), 10), labels=c('???', expression(paste(sigma[e]^2, ' = 1.0')), expression(paste(sigma[e]^2, ' = 0.5')), expression(paste(sigma[e]^2, ' = 0.1')), expression(paste(sigma[e]^2, ' = 0.05')), '???'), las=1, cex.axis=1.3)
axis(side=2, at=c(1e-100, 1e100), labels=F)
axis(side=4, at=c(1e-100, 1e100), labels=F)
axis(side=2, at=c(1e-5, 1e-4, 1e-3, 1e-2, 1e-1, 1), las=1, labels=c('0.00001', '0.0001', '0.001', '0.01', '0.1', '1.0'), cex.axis=1.3)
axis(side=2, at=c(seq(1e-4,1e-3,1e-4), seq(1e-3,1e-2,1e-3), seq(1e-2,1e-1,1e-2), seq(1e-1,1e0,1e-1), seq(1e0, 10, 1)), labels=F)
legend(par('usr')[2], par('usr')[4], legend = c(expression(hat(beta)), expression(paste('naive, ', sigma[0]^2 == 1.0)), expression(paste('naive, ', sigma[0]^2 == 10^-2)), expression(paste('naive, ', sigma[0]^2 == 10^-4)), expression(paste('naive, ', sigma[0]^2 == 10^-10)), 'new VI scheme') ,pch=rep(19,6), col=cols[1:6], y.intersp=1.2, bty='n', xpd='NA', cex=1.3)
dev.off()


pdf('../figs/cor_plot.pdf')

plot(1, type='n', xlab = '', xlim = c(0.5, 4.5), ylim = c(0, 1e0), axes='F', ylab='Correlation', cex.lab = 1.3)

points(jitter(rep(4-0.375, 1000), factor=0, amount=0.03), cor005[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(4-0.35, 4-0.4), c(mean(cor005[,1]), mean(cor005[,1])), lwd=3)
lines(c(4-0.375, 4-0.376), c(quantile(cor005[,1], 0.25), quantile(cor005[,1], 0.75)))
points(jitter(rep(4-0.225, 1000), factor=0, amount=0.03), cor005[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(4-0.2, 4-0.25), c(mean(cor005[,3]), mean(cor005[,3])), lwd=3)
lines(c(4-0.225, 4-0.225), c(quantile(cor005[,3], 0.25), quantile(cor005[,3], 0.75)))
points(jitter(rep(4-0.075, 1000), factor=0, amount=0.03), cor005[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(4-0.05, 4-0.1), c(mean(cor005[,5]), mean(cor005[,5])), lwd=3)
lines(c(4-0.075, 4-0.075), c(quantile(cor005[,5], 0.25), quantile(cor005[,5], 0.75)))
points(jitter(rep(4+0.075, 1000), factor=0, amount=0.03), cor005[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(4+0.05, 4+0.1), c(mean(cor005[,7]), mean(cor005[,7])), lwd=3)
lines(c(4+0.075, 4+0.075), c(quantile(cor005[,7], 0.25), quantile(cor005[,7], 0.75)))
points(jitter(rep(4+0.225, 1000), factor=0, amount=0.03), cor005[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(4+0.2, 4+0.25), c(mean(cor005[,9]), mean(cor005[,9])), lwd=3)
lines(c(4+0.225, 4+0.225), c(quantile(cor005[,9], 0.25), quantile(cor005[,9], 0.75)))
points(jitter(rep(4+0.375, 1000), factor=0, amount=0.03), cor005[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(4+0.35, 4+0.4), c(mean(cor005[,10]), mean(cor005[,10])), lwd=3)
lines(c(4+0.375, 4+0.375), c(quantile(cor005[,10], 0.25), quantile(cor005[,10], 0.75)))

points(jitter(rep(3-0.375, 1000), factor=0, amount=0.03), cor01[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(3-0.35, 3-0.4), c(mean(cor01[,1]), mean(cor01[,1])), lwd=3)
lines(c(3-0.375, 3-0.376), c(quantile(cor01[,1], 0.25), quantile(cor01[,1], 0.75)))
points(jitter(rep(3-0.225, 1000), factor=0, amount=0.03), cor01[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(3-0.2, 3-0.25), c(mean(cor01[,3]), mean(cor01[,3])), lwd=3)
lines(c(3-0.225, 3-0.225), c(quantile(cor01[,3], 0.25), quantile(cor01[,3], 0.75)))
points(jitter(rep(3-0.075, 1000), factor=0, amount=0.03), cor01[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(3-0.05, 3-0.1), c(mean(cor01[,5]), mean(cor01[,5])), lwd=3)
lines(c(3-0.075, 3-0.075), c(quantile(cor01[,5], 0.25), quantile(cor01[,5], 0.75)))
points(jitter(rep(3+0.075, 1000), factor=0, amount=0.03), cor01[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(3+0.05, 3+0.1), c(mean(cor01[,7]), mean(cor01[,7])), lwd=3)
lines(c(3+0.075, 3+0.075), c(quantile(cor01[,7], 0.25), quantile(cor01[,7], 0.75)))
points(jitter(rep(3+0.225, 1000), factor=0, amount=0.03), cor01[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(3+0.2, 3+0.25), c(mean(cor01[,9]), mean(cor01[,9])), lwd=3)
lines(c(3+0.225, 3+0.225), c(quantile(cor01[,9], 0.25), quantile(cor01[,9], 0.75)))
points(jitter(rep(3+0.375, 1000), factor=0, amount=0.03), cor01[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(3+0.35, 3+0.4), c(mean(cor01[,10]), mean(cor01[,10])), lwd=3)
lines(c(3+0.375, 3+0.375), c(quantile(cor01[,10], 0.25), quantile(cor01[,10], 0.75)))


points(jitter(rep(2-0.375, 1000), factor=0, amount=0.03), cor05[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(2-0.35, 2-0.4), c(mean(cor05[,1], na.rm=T), mean(cor05[,1], na.rm=T)), lwd=3)
lines(c(2-0.375, 2-0.376), c(quantile(cor05[,1], 0.25, na.rm=T), quantile(cor05[,1], 0.75, na.rm=T)))
points(jitter(rep(2-0.225, 1000), factor=0, amount=0.03), cor05[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(2-0.2, 2-0.25), c(mean(cor05[,3], na.rm=T), mean(cor05[,3], na.rm=T)), lwd=3)
lines(c(2-0.225, 2-0.225), c(quantile(cor05[,3], 0.25, na.rm=T), quantile(cor05[,3], 0.75, na.rm=T)))
points(jitter(rep(2-0.075, 1000), factor=0, amount=0.03), cor05[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(2-0.05, 2-0.1), c(mean(cor05[,5], na.rm=T), mean(cor05[,5], na.rm=T)), lwd=3)
lines(c(2-0.075, 2-0.075), c(quantile(cor05[,5], 0.25, na.rm=T), quantile(cor05[,5], 0.75, na.rm=T)))
points(jitter(rep(2+0.075, 1000), factor=0, amount=0.03), cor05[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(2+0.05, 2+0.1), c(mean(cor05[,7], na.rm=T), mean(cor05[,7], na.rm=T)), lwd=3)
lines(c(2+0.075, 2+0.075), c(quantile(cor05[,7], 0.25, na.rm=T), quantile(cor05[,7], 0.75, na.rm=T)))
points(jitter(rep(2+0.225, 1000), factor=0, amount=0.03), cor05[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(2+0.2, 2+0.25), c(mean(cor05[,9], na.rm=T), mean(cor05[,9], na.rm=T)), lwd=3)
lines(c(2+0.225, 2+0.225), c(quantile(cor05[,9], 0.25, na.rm=T), quantile(cor05[,9], 0.75, na.rm=T)))
points(jitter(rep(2+0.375, 1000), factor=0, amount=0.03), cor05[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(2+0.35, 2+0.4), c(mean(cor05[,10], na.rm=T), mean(cor05[,10], na.rm=T)), lwd=3)
lines(c(2+0.375, 2+0.375), c(quantile(cor05[,10], 0.25, na.rm=T), quantile(cor05[,10], 0.75, na.rm=T)))



points(jitter(rep(1-0.375, 1000), factor=0, amount=0.03), cor1[,1], col=adjustcolor(cols[1], alpha.f=0.04))
lines(c(1-0.35, 1-0.4), c(mean(cor1[,1]), mean(cor1[,1])), lwd=3)
lines(c(1-0.375, 1-0.376), c(quantile(cor1[,1], 0.25), quantile(cor1[,1], 0.75)))
points(jitter(rep(1-0.225, 1000), factor=0, amount=0.03), cor1[,3], col=adjustcolor(cols[2], alpha.f=0.04))
lines(c(1-0.2, 1-0.25), c(mean(cor1[,3]), mean(cor1[,3])), lwd=3)
lines(c(1-0.225, 1-0.225), c(quantile(cor1[,3], 0.25), quantile(cor1[,3], 0.75)))
points(jitter(rep(1-0.075, 1000), factor=0, amount=0.03), cor1[,5], col=adjustcolor(cols[3], alpha.f=0.04))
lines(c(1-0.05, 1-0.1), c(mean(cor1[,5]), mean(cor1[,5])), lwd=3)
lines(c(1-0.075, 1-0.075), c(quantile(cor1[,5], 0.25), quantile(cor1[,5], 0.75)))
points(jitter(rep(1+0.075, 1000), factor=0, amount=0.03), cor1[,7], col=adjustcolor(cols[4], alpha.f=0.04))
lines(c(1+0.05, 1+0.1), c(mean(cor1[,7]), mean(cor1[,7])), lwd=3)
lines(c(1+0.075, 1+0.075), c(quantile(cor1[,7], 0.25), quantile(cor1[,7], 0.75)))
points(jitter(rep(1+0.225, 1000), factor=0, amount=0.03), cor1[,9], col=adjustcolor(cols[5], alpha.f=0.04))
lines(c(1+0.2, 1+0.25), c(mean(cor1[,9]), mean(cor1[,9])), lwd=3)
lines(c(1+0.225, 1+0.225), c(quantile(cor1[,9], 0.25), quantile(cor1[,9], 0.75)))
points(jitter(rep(1+0.375, 1000), factor=0, amount=0.03), cor1[,10], col=adjustcolor(cols[6], alpha.f=0.04))
lines(c(1+0.35, 1+0.4), c(mean(cor1[,10]), mean(cor1[,10])), lwd=3)
lines(c(1+0.375, 1+0.375), c(quantile(cor1[,10], 0.25), quantile(cor1[,10], 0.75)))

axis(side=1, at = c(-10, 10), labels=F)
axis(side=3, at = c(-10, 10), labels=F)
axis(side=1, at=c(-10, seq(1,4,1), 10), labels=c('???', expression(paste(sigma[e]^2, ' = 1.0')), expression(paste(sigma[e]^2, ' = 0.5')), expression(paste(sigma[e]^2, ' = 0.1')), expression(paste(sigma[e]^2, ' = 0.05')), '???'), las=1, cex.axis=1.3)
axis(side=4, at=c(-10, 10), labels=F)
axis(side=2, at=c(-10, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 10), las=1, cex.axis=1.3)
axis(side=2, at=seq(-2, 2, 0.1), labels=F)
dev.off()
